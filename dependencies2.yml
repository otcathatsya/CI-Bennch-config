modules: &module-list >-
  Stages/2022
  GCCcore/.11.2.0
  GCC/11.2.0
  CMake/3.21.1
  ParaStationMPI/5.5.0-1
  Python/3.9.6
  SciPy-bundle/2021.10
  matplotlib/3.4.3
  mpi4py/3.1.3
  GSL/2.7
  jemalloc/5.2.1
  Boost/1.78.0
  Autotools/20210726
  git/2.33.1-nodocs
  PyYAML/5.4.1
  JUBE/2.5.1
pip: &pip-list >-
  future
  nested_dict
  dicthash
  IPython
  jupyter
  nbconvert
jureca:
  variables:
    TEMP_DIR: "$$SCRATCH_cjinb33/ci-bennch/jureca/userdata"   # Directory to temporary files accessible from both login and compute nodes
    USERSOFTWARE_DIR: "$$USERSOFTWARE_djinb33/ci-bennch/jureca"
    MODULE_LIST: *module-list
    PIP_LIST: *pip-list
  init:
    - 'eval TEMP_DIR="$TEMP_DIR"'
    - 'eval USERSOFTWARE_DIR="$USERSOFTWARE_DIR"'
    - 'module load $MODULE_LIST'
    - 'python -m venv --system-site-packages benchmarking-env'
    - 'benchmarking-env/bin/pip install $PIP_LIST'
    - 'ln -s "$USERSOFTWARE_DIR/builder/build.sh" "$(pwd)/build"'
  load:
    - 'eval TEMP_DIR="$TEMP_DIR"'
    - 'eval USERSOFTWARE_DIR="$USERSOFTWARE_DIR"'
    - 'module load $MODULE_LIST'
    - 'jutil env activate -p djinb33'
    - 'source benchmarking-env/bin/activate'
    - 'export PYTHONPATH="$PYTHONPATH:$USERSOFTWARE_DIR/bennchplot/"'
    - 'export PATH="$(pwd):$USERSOFTWARE_DIR/git-annex:$PATH"'
jusuf:
  variables:
    TEMP_DIR: "$$SCRATCH_cjinb33/ci-bennch/jusuf/userdata"   # Directory to temporary files accessible from both login and compute nodes
    USERSOFTWARE_DIR: "$$USERSOFTWARE_djinb33/ci-bennch/jusuf"
    MODULE_LIST: *module-list
    PIP_LIST: *pip-list
  init:
    - 'eval TEMP_DIR="$TEMP_DIR"'
    - 'eval USERSOFTWARE_DIR="$USERSOFTWARE_DIR"'
    - 'module load $MODULE_LIST'
    - 'python -m venv --system-site-packages benchmarking-env'
    - 'benchmarking-env/bin/pip install $PIP_LIST'
    - 'ln -s "$USERSOFTWARE_DIR/builder/build.sh" "$(pwd)/build"'
  load:
    - 'eval TEMP_DIR="$TEMP_DIR"'
    - 'eval USERSOFTWARE_DIR="$USERSOFTWARE_DIR"'
    - 'module load $MODULE_LIST'
    - 'jutil env activate -p djinb33'
    - 'source benchmarking-env/bin/activate'
    - 'export PYTHONPATH="$PYTHONPATH:$USERSOFTWARE_DIR/bennchplot/"'
    - 'export PATH="$(pwd):$USERSOFTWARE_DIR/git-annex:$PATH"'
